<!DOCTYPE HTML>
<html>

<head>
    <title>Appear</title>
    <script src="static/vis_server.js"></script>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script type="text/javascript" charset="utf-8">
    // Visualization functions
    function update_stopping_criteria(msg) {
        disease_data = []
        for (var disease in msg.scores) {
            disease_data.push({ x: msg.questions, y: msg.scores[disease], name: disease })
        }
        Plotly.newPlot('myChart', disease_data, { title: 'Score Convergence Condition', margin: { b: 350 }, height: 1000 });
    }

    function update_answered_entities(msg) {
        document.getElementById("answeredEntities").textContent = "Number of answered entities " + msg.entities + " out of " + msg.limit
    }

    function update_all_entities(msg) {
        document.getElementById("allEntities").textContent = "Number of entities " + msg.entities + " out of " + msg.limit
    }

    // Link visualization functions to content
    server = new VisServer()
    server.subscribe("stopping_criteria", update_stopping_criteria)
    server.subscribe("answeredEntities", update_answered_entities)
    server.subscribe("allEntities", update_all_entities)
    </script>
</head>

<body>
    <h1>Appear</h1>
    <p id="answeredEntities"></p>
    <p id="allEntities"></p>
    <div id="myChart"></div>
</body>

</html>